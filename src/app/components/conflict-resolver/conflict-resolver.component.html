<div class="min-h-screen bg-gray-50 flex items-center justify-center px-4 py-6">
  <div *ngIf="store.conflicts().length > 0" class="w-full max-w-4xl bg-white p-6 rounded-xl shadow-lg">
    <div class="text-center mb-6">
      <div class="text-yellow-500 text-4xl mb-2">
        <i class="pi pi-exclamation-triangle"></i>
      </div>
      <h2 class="text-2xl font-bold text-gray-800">Sync Conflict Detected</h2>
      <p class="text-gray-600 mt-1 text-sm">
        The note "<strong>{{ store.conflicts()[0].localNote.title }}</strong>" has been modified on multiple devices.
        Choose a version to keep or merge changes manually.
      </p>
    </div>

    <!-- Conflict Comparison -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
      <!-- Local Version -->
      <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
        <h3 class="text-blue-600 font-semibold mb-2">Local Version</h3>
        <p class="text-sm text-gray-700 whitespace-pre-line mb-2">
          {{ store.conflicts()[0].localNote.content }}
        </p>
        <p class="text-xs text-gray-500 mb-1">
          Last Updated: {{ store.conflicts()[0].localNote.updatedAt.toDate() | date:'MMM d, y, h:mm a' }}
        </p>
        <p class="text-xs text-gray-500 mb-3">
          Word Count: {{ getWordCount(store.conflicts()[0].localNote.content) }}
        </p>
        <button
          (click)="keepLocal()"
          class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 text-sm rounded"
        >
          Keep Local Version
        </button>
      </div>

      <!-- Server Version -->
      <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
        <h3 class="text-indigo-600 font-semibold mb-2">Server Version</h3>
        <p class="text-sm text-gray-700 whitespace-pre-line mb-2">
          {{ store.conflicts()[0].serverNote.content }}
        </p>
        <p class="text-xs text-gray-500 mb-1">
          Last Updated: {{ store.conflicts()[0].serverNote.updatedAt.toDate() | date:'MMM d, y, h:mm a' }}
        </p>
        <p class="text-xs text-gray-500 mb-3">
          Word Count: {{ getWordCount(store.conflicts()[0].serverNote.content) }}
        </p>
        <button
          (click)="keepServer()"
          class="w-full bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 text-sm rounded"
        >
          Keep Server Version
        </button>
      </div>
    </div>

    <!-- Advanced Options -->
    <div class="space-y-4">
      <h3 class="text-lg font-semibold text-gray-800">Advanced Options</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <button
          (click)="toggleManualMerge()"
          class="w-full border border-gray-300 text-sm px-4 py-2 rounded hover:bg-gray-100"
        >
          Manually Merge Both Versions
        </button>
        <button
          (click)="saveBoth()"
          class="w-full border border-gray-300 text-sm px-4 py-2 rounded hover:bg-gray-100"
        >
          Save Both Versions Separately
        </button>
      </div>
      <p class="text-sm text-blue-700 bg-blue-50 p-3 rounded">
        <strong>Tip:</strong> Use manual merge to combine the best parts, or save both versions separately to avoid data loss.
      </p>
    </div>
  </div>

  <!-- Manual Merge Section -->
  <div *ngIf="showManualMerge" class="fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm flex items-center justify-center px-4">
    <div class="bg-white rounded-xl w-full max-w-xl p-6 space-y-4 shadow-2xl">
      <h3 class="text-xl font-semibold text-gray-800">Manual Merge</h3>
      <p class="text-sm text-gray-600">
        Combine content from both versions and save it as one merged note.
      </p>
      <textarea
        [(ngModel)]="mergedContent"
        rows="6"
        class="w-full px-3 py-2 border border-gray-300 rounded resize-y focus:ring focus:ring-blue-200 text-sm"
      ></textarea>
      <p class="text-xs text-gray-400">Word Count: {{ getWordCount(mergedContent) }}</p>
      <div class="flex justify-end gap-2">
        <button
          (click)="showManualMerge = false"
          class="px-4 py-2 text-sm border border-gray-300 rounded hover:bg-gray-100"
        >
          Cancel
        </button>
        <button
          (click)="mergeManually()"
          class="px-4 py-2 text-sm bg-green-600 hover:bg-green-700 text-white rounded"
        >
          Save Merged Version
        </button>
      </div>
    </div>
  </div>
</div>
